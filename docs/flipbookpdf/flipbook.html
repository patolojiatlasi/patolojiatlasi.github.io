<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patoloji Atlasi Flipbook</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="turn.min.js"></script>
    <script src="pdfjs/build/pdf.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        #flipbook {
            width: 90vw;
            height: 80vh;
        }
        #flipbook .page {
            background-color: white;
        }
        #debug {
            margin-top: 20px;
            width: 90vw;
            height: 10vh;
            overflow: auto;
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div id="flipbook"></div>
    <div id="debug"></div>
    <script>
        function log(message) {
            console.log(message);
            document.getElementById('debug').innerHTML += message + '<br>';
        }

        log('Script started');

        pdfjsLib.GlobalWorkerOptions.workerSrc = 'pdfjs/build/pdf.worker.js';

        pdfjsLib.getDocument('Patoloji-Atlasi.pdf').promise.then(function(pdf) {
            log('PDF loaded. Number of pages: ' + pdf.numPages);
            var flipbook = document.getElementById('flipbook');

            for (var i = 1; i <= pdf.numPages; i++) {
                pdf.getPage(i).then(function(page) {
                    var scale = 1.5;
                    var viewport = page.getViewport({scale: scale});

                    var pageDiv = document.createElement('div');
                    pageDiv.className = 'page';
                    flipbook.appendChild(pageDiv);

                    var canvas = document.createElement('canvas');
                    var context = canvas.getContext('2d');
                    canvas.height = viewport.height;
                    canvas.width = viewport.width;

                    var renderContext = {
                        canvasContext: context,
                        viewport: viewport
                    };

                    page.render(renderContext);
                    pageDiv.appendChild(canvas);

                    log('Page ' + page.pageNumber + ' rendered');

                    if (page.pageNumber === pdf.numPages) {
                        log('All pages rendered. Initializing flipbook.');
                        .turn({
                            width: flipbook.offsetWidth,
                            height: flipbook.offsetHeight,
                            autoCenter: true
                        });
                    }
                });
            }
        }).catch(function(error) {
            log('Error loading PDF: ' + error);
        });

        log('Script ended');
    </script>
</body>
</html>
